{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import axios from'axios';import'./App.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[animalCounts,setAnimalCounts]=useState({});const videoRef=useRef(null);const canvasRef=useRef(null);useEffect(()=>{const startCamera=async()=>{try{const stream=await navigator.mediaDevices.getUserMedia({video:true});if(videoRef.current){videoRef.current.srcObject=stream;}}catch(error){console.error('Error accessing the camera:',error);}};startCamera();const captureFrame=async()=>{if(videoRef.current&&canvasRef.current){const canvas=canvasRef.current;const context=canvas.getContext('2d');canvas.width=videoRef.current.videoWidth;canvas.height=videoRef.current.videoHeight;context.drawImage(videoRef.current,0,0,canvas.width,canvas.height);const dataURL=canvas.toDataURL('image/jpeg');const response=await fetch(dataURL);const blob=await response.blob();const formData=new FormData();formData.append('file',blob,'image.jpg');try{console.log('Sending image data to server...');const res=await axios.post('http://localhost:5001/detect',formData,{headers:{'Content-Type':'multipart/form-data'}});console.log('Server response:',res.data);setAnimalCounts(res.data);}catch(error){console.error('Error fetching animal counts:',error);}}};const interval=setInterval(()=>{captureFrame();},5000);// Capture and send every 5 seconds\nreturn()=>clearInterval(interval);// Cleanup on component unmount\n},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"camera-preview\",children:[/*#__PURE__*/_jsx(\"video\",{ref:videoRef,autoPlay:true,style:{width:'100%',height:'auto'}}),/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,style:{display:'none'}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"animal-counts\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Animal Counts:\"}),/*#__PURE__*/_jsxs(\"table\",{children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"Animal\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Count\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:Object.entries(animalCounts).length===0?/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{colSpan:\"2\",children:\"No data available\"})}):Object.entries(animalCounts).map(_ref=>{let[animal,count]=_ref;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:animal}),/*#__PURE__*/_jsx(\"td\",{children:count})]},animal);})})]})]})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useRef","axios","jsx","_jsx","jsxs","_jsxs","App","animalCounts","setAnimalCounts","videoRef","canvasRef","startCamera","stream","navigator","mediaDevices","getUserMedia","video","current","srcObject","error","console","captureFrame","canvas","context","getContext","width","videoWidth","height","videoHeight","drawImage","dataURL","toDataURL","response","fetch","blob","formData","FormData","append","log","res","post","headers","data","interval","setInterval","clearInterval","className","children","ref","autoPlay","style","display","Object","entries","length","colSpan","map","_ref","animal","count"],"sources":["/Users/mugunthansaravanan/Desktop/count/new/count/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport './App.css';\n\nfunction App() {\n  const [animalCounts, setAnimalCounts] = useState({});\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n\n  useEffect(() => {\n    const startCamera = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n        }\n      } catch (error) {\n        console.error('Error accessing the camera:', error);\n      }\n    };\n\n    startCamera();\n\n    const captureFrame = async () => {\n      if (videoRef.current && canvasRef.current) {\n        const canvas = canvasRef.current;\n        const context = canvas.getContext('2d');\n        canvas.width = videoRef.current.videoWidth;\n        canvas.height = videoRef.current.videoHeight;\n        context.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n        const dataURL = canvas.toDataURL('image/jpeg');\n\n        const response = await fetch(dataURL);\n        const blob = await response.blob();\n        const formData = new FormData();\n        formData.append('file', blob, 'image.jpg');\n\n        try {\n          console.log('Sending image data to server...');\n          const res = await axios.post('http://localhost:5001/detect', formData, {\n            headers: {\n              'Content-Type': 'multipart/form-data',\n            },\n          });\n          console.log('Server response:', res.data);\n          setAnimalCounts(res.data);\n        } catch (error) {\n          console.error('Error fetching animal counts:', error);\n        }\n      }\n    };\n\n    const interval = setInterval(() => {\n      captureFrame();\n    }, 5000); // Capture and send every 5 seconds\n\n    return () => clearInterval(interval); // Cleanup on component unmount\n  }, []);\n\n  return (\n    <div className=\"container\">\n      <div className=\"camera-preview\">\n        <video ref={videoRef} autoPlay style={{ width: '100%', height: 'auto' }} />\n        <canvas ref={canvasRef} style={{ display: 'none' }} />\n      </div>\n      <div className=\"animal-counts\">\n        <h2>Animal Counts:</h2>\n        <table>\n          <thead>\n            <tr>\n              <th>Animal</th>\n              <th>Count</th>\n            </tr>\n          </thead>\n          <tbody>\n            {Object.entries(animalCounts).length === 0 ? (\n              <tr>\n                <td colSpan=\"2\">No data available</td>\n              </tr>\n            ) : (\n              Object.entries(animalCounts).map(([animal, count]) => (\n                <tr key={animal}>\n                  <td>{animal}</td>\n                  <td>{count}</td>\n                </tr>\n              ))\n            )}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CAC1D,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,WAAW,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAEnB,QAAS,CAAAC,GAAGA,CAAA,CAAG,CACb,KAAM,CAACC,YAAY,CAAEC,eAAe,CAAC,CAAGV,QAAQ,CAAC,CAAC,CAAC,CAAC,CACpD,KAAM,CAAAW,QAAQ,CAAGT,MAAM,CAAC,IAAI,CAAC,CAC7B,KAAM,CAAAU,SAAS,CAAGV,MAAM,CAAC,IAAI,CAAC,CAE9BD,SAAS,CAAC,IAAM,CACd,KAAM,CAAAY,WAAW,CAAG,KAAAA,CAAA,GAAY,CAC9B,GAAI,CACF,KAAM,CAAAC,MAAM,CAAG,KAAM,CAAAC,SAAS,CAACC,YAAY,CAACC,YAAY,CAAC,CAAEC,KAAK,CAAE,IAAK,CAAC,CAAC,CACzE,GAAIP,QAAQ,CAACQ,OAAO,CAAE,CACpBR,QAAQ,CAACQ,OAAO,CAACC,SAAS,CAAGN,MAAM,CACrC,CACF,CAAE,MAAOO,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,6BAA6B,CAAEA,KAAK,CAAC,CACrD,CACF,CAAC,CAEDR,WAAW,CAAC,CAAC,CAEb,KAAM,CAAAU,YAAY,CAAG,KAAAA,CAAA,GAAY,CAC/B,GAAIZ,QAAQ,CAACQ,OAAO,EAAIP,SAAS,CAACO,OAAO,CAAE,CACzC,KAAM,CAAAK,MAAM,CAAGZ,SAAS,CAACO,OAAO,CAChC,KAAM,CAAAM,OAAO,CAAGD,MAAM,CAACE,UAAU,CAAC,IAAI,CAAC,CACvCF,MAAM,CAACG,KAAK,CAAGhB,QAAQ,CAACQ,OAAO,CAACS,UAAU,CAC1CJ,MAAM,CAACK,MAAM,CAAGlB,QAAQ,CAACQ,OAAO,CAACW,WAAW,CAC5CL,OAAO,CAACM,SAAS,CAACpB,QAAQ,CAACQ,OAAO,CAAE,CAAC,CAAE,CAAC,CAAEK,MAAM,CAACG,KAAK,CAAEH,MAAM,CAACK,MAAM,CAAC,CACtE,KAAM,CAAAG,OAAO,CAAGR,MAAM,CAACS,SAAS,CAAC,YAAY,CAAC,CAE9C,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAACH,OAAO,CAAC,CACrC,KAAM,CAAAI,IAAI,CAAG,KAAM,CAAAF,QAAQ,CAACE,IAAI,CAAC,CAAC,CAClC,KAAM,CAAAC,QAAQ,CAAG,GAAI,CAAAC,QAAQ,CAAC,CAAC,CAC/BD,QAAQ,CAACE,MAAM,CAAC,MAAM,CAAEH,IAAI,CAAE,WAAW,CAAC,CAE1C,GAAI,CACFd,OAAO,CAACkB,GAAG,CAAC,iCAAiC,CAAC,CAC9C,KAAM,CAAAC,GAAG,CAAG,KAAM,CAAAtC,KAAK,CAACuC,IAAI,CAAC,8BAA8B,CAAEL,QAAQ,CAAE,CACrEM,OAAO,CAAE,CACP,cAAc,CAAE,qBAClB,CACF,CAAC,CAAC,CACFrB,OAAO,CAACkB,GAAG,CAAC,kBAAkB,CAAEC,GAAG,CAACG,IAAI,CAAC,CACzClC,eAAe,CAAC+B,GAAG,CAACG,IAAI,CAAC,CAC3B,CAAE,MAAOvB,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,+BAA+B,CAAEA,KAAK,CAAC,CACvD,CACF,CACF,CAAC,CAED,KAAM,CAAAwB,QAAQ,CAAGC,WAAW,CAAC,IAAM,CACjCvB,YAAY,CAAC,CAAC,CAChB,CAAC,CAAE,IAAI,CAAC,CAAE;AAEV,MAAO,IAAMwB,aAAa,CAACF,QAAQ,CAAC,CAAE;AACxC,CAAC,CAAE,EAAE,CAAC,CAEN,mBACEtC,KAAA,QAAKyC,SAAS,CAAC,WAAW,CAAAC,QAAA,eACxB1C,KAAA,QAAKyC,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7B5C,IAAA,UAAO6C,GAAG,CAAEvC,QAAS,CAACwC,QAAQ,MAACC,KAAK,CAAE,CAAEzB,KAAK,CAAE,MAAM,CAAEE,MAAM,CAAE,MAAO,CAAE,CAAE,CAAC,cAC3ExB,IAAA,WAAQ6C,GAAG,CAAEtC,SAAU,CAACwC,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAO,CAAE,CAAE,CAAC,EACnD,CAAC,cACN9C,KAAA,QAAKyC,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5B5C,IAAA,OAAA4C,QAAA,CAAI,gBAAc,CAAI,CAAC,cACvB1C,KAAA,UAAA0C,QAAA,eACE5C,IAAA,UAAA4C,QAAA,cACE1C,KAAA,OAAA0C,QAAA,eACE5C,IAAA,OAAA4C,QAAA,CAAI,QAAM,CAAI,CAAC,cACf5C,IAAA,OAAA4C,QAAA,CAAI,OAAK,CAAI,CAAC,EACZ,CAAC,CACA,CAAC,cACR5C,IAAA,UAAA4C,QAAA,CACGK,MAAM,CAACC,OAAO,CAAC9C,YAAY,CAAC,CAAC+C,MAAM,GAAK,CAAC,cACxCnD,IAAA,OAAA4C,QAAA,cACE5C,IAAA,OAAIoD,OAAO,CAAC,GAAG,CAAAR,QAAA,CAAC,mBAAiB,CAAI,CAAC,CACpC,CAAC,CAELK,MAAM,CAACC,OAAO,CAAC9C,YAAY,CAAC,CAACiD,GAAG,CAACC,IAAA,MAAC,CAACC,MAAM,CAAEC,KAAK,CAAC,CAAAF,IAAA,oBAC/CpD,KAAA,OAAA0C,QAAA,eACE5C,IAAA,OAAA4C,QAAA,CAAKW,MAAM,CAAK,CAAC,cACjBvD,IAAA,OAAA4C,QAAA,CAAKY,KAAK,CAAK,CAAC,GAFTD,MAGL,CAAC,EACN,CACF,CACI,CAAC,EACH,CAAC,EACL,CAAC,EACH,CAAC,CAEV,CAEA,cAAe,CAAApD,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}